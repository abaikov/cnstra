"use strict";(self.webpackChunkcnstra_docs=self.webpackChunkcnstra_docs||[]).push([[22],{6189:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"integrations/rabbitmq","title":"RabbitMQ Integration","description":"Use RabbitMQ queues to trigger CNStra runs.","source":"@site/integrations/rabbitmq.md","sourceDirName":"integrations","slug":"/integrations/rabbitmq","permalink":"/docs/integrations/rabbitmq","draft":false,"unlisted":false,"editUrl":"https://github.com/abaikov/cnstra/edit/master/docs/integrations/rabbitmq.md","tags":[],"version":"current","lastUpdatedAt":1759800880000,"frontMatter":{"id":"rabbitmq","title":"RabbitMQ Integration","sidebar_label":"RabbitMQ","slug":"/integrations/rabbitmq"},"sidebar":"docs","previous":{"title":"BullMQ","permalink":"/docs/integrations/bullmq"},"next":{"title":"Custom Context Store","permalink":"/docs/advanced/custom-context-store"}}');var r=n(4848),a=n(8453);const i={id:"rabbitmq",title:"RabbitMQ Integration",sidebar_label:"RabbitMQ",slug:"/integrations/rabbitmq"},o=void 0,c={},l=[];function u(t){const e={code:"code",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...t.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"Use RabbitMQ queues to trigger CNStra runs."}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import amqplib from 'amqplib';\nimport { CNS } from '@cnstra/core';\n\nconst conn = await amqplib.connect(process.env.AMQP_URL!);\nconst ch = await conn.createChannel();\nawait ch.assertQueue('events');\n\nconst cns = new CNS();\nch.consume('events', async msg => {\n  if (!msg) return;\n  const payload = JSON.parse(msg.content.toString());\n  await cns.stimulate(myCollateral.createSignal(payload));\n  ch.ack(msg);\n});\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Use prefetch and consumer concurrency to apply backpressure"}),"\n",(0,r.jsx)(e.li,{children:"Consider dead-letter exchanges for poison messages"}),"\n"]})]})}function d(t={}){const{wrapper:e}={...(0,a.R)(),...t.components};return e?(0,r.jsx)(e,{...t,children:(0,r.jsx)(u,{...t})}):u(t)}},8453:(t,e,n)=>{n.d(e,{R:()=>i,x:()=>o});var s=n(6540);const r={},a=s.createContext(r);function i(t){const e=s.useContext(a);return s.useMemo(function(){return"function"==typeof t?t(e):{...e,...t}},[e,t])}function o(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(r):t.components||r:i(t.components),s.createElement(a.Provider,{value:e},t.children)}}}]);